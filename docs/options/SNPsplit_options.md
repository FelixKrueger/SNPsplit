# SNPsplit 

## Full list of options for SNPsplit

**USAGE:** `SNPsplit [options] --snp_file <SNP.file.gz> [input file(s)]`



`Input file(s)`

- Mapping output file in SAM or BAM format. SAM files (ending in `.sam`) will first be converted to BAM files.

`--snp_file`

- Mandatory file specifying SNP positions to be considered, may be a plain text file of gzip compressed. Currently, the SNP file is expected to be in the following format:

```
   SNP-ID     Chromosome  Position    Strand   Ref/SNP
 33941939           9             68878541       1           T/G
```

	Only the information contained in fields 'Chromosome', 'Position' and 'Ref/SNP base' are being used for analysis. The genome referred to as 'Ref' will be used as genome 1, the genome containing the 'SNP' base as genome 2.

`--paired`
- Paired-end mode. (Default: OFF).

`-o/--outdir <dir>`
- Write all output files into this directory. By default the output files will be written into the same folder as the input file(s). If the specified folder does not exist, SNPsplit will attempt to create it first. The path to the output folder can be either relative or absolute.


`--singletons`
- If the allele-tagged paired-end file also contains singleton alignments (which is the default for e.g. TopHat), these will be written out to extra files (ending in `_st.bam`) instead of writing everything to combined paired-end and singleton files. Default: OFF.

`--no_sort`
- This option skips the sorting step if BAM files are already sorted by read name (e.g. Hi-C files generated by [HiCUP](https://www.bioinformatics.babraham.ac.uk/projects/hicup/)). Please note that setting `--no_sort` for unsorted paired-end  files will break the tagging process!

`--hic`
- Assumes Hi-C data processed with [HiCUP](www.bioinformatics.babraham.ac.uk/projects/hicup/) as input, i.e. the input BAM file is paired-end and Reads 1 and 2 follow each other. Thus, this option also sets the flags `--paired` and `--no_sort`. Default: OFF.

`--bisulfite`
- Assumes Bisulfite-Seq data processed with [Bismark](https://github.com/FelixKrueger/Bismark) as input. In paired-end mode (`--paired`), Read 1 and Read 2 of a pair are expected to follow each other in consecutive lines. SNPsplit will run a quick check at the start of a run to see if the provided file appears to be a Bismark file, and set the flags `--bisulfite` and/or `--paired` automatically. In addition it will perform a quick check to see if a paired-end file appears to have been positionally sorted, and if not will set the flag `--no_sort`.

`--samtools-path`
- The path to your Samtools installation, e.g. `/home/user/samtools/`. Does not need to be specified explicitly if Samtools is in the `PATH` environment already.

## SNPsplit-sort specific options (tag2sort):

`--sam`
- The output will be written out in SAM format instead of the default BAM format. SNPsplit will attempt to use the path to Samtools that was specified with `--samtools_path`, or, if it hasn't been specified, attempt to find Samtools in the `PATH` environment. 

`--conflicting/--weird`
- Reads or read pairs that were classified as 'Conflicting' (`XX:Z:CF`) will be written to an extra file (ending in `.conflicting.bam`) instead of being simply skipped. Reads may be classified as 'Conflicting' if a single read contains SNP information for both genomes at the same time, or if the SNP position was deleted from the read. Read-pairs are considered 'Conflicting' if either read is was tagged with the `XX:Z:CF` flag. Default: OFF.

`--help`
- Displays this help information and exits.

`--verbose`
(Very!) verbose output (for debugging).

`--version`
- Displays version information and exits.
â€ƒ
## Full list of options for SNPsplit_genome_preparation


**USAGE:** `SNPsplit_genome_preparation [options] --vcf_file <file> --reference_genome /path/to/genome/ --strain <strain_name>`


`--vcf_file <file>`
- Mandatory file specifying SNP information for mouse strains from the [Mouse Genomes Project](http://www.sanger.ac.uk/science/data/mouse-genomes-project). The file approved and tested is called `mgp.v5.merged.snps_all.dbSNP142.vcf.gz`. Please note that future versions of this file or entirely different VCF files might not work out-of-the-box but may require some tweaking. SNP calls are read from the VCF files, and high confidence SNPs are written into a folder in the current working directory called `SNPs_<strain_name>/chr<chromosome>.txt`, in the following format:
```
        SNP-ID     Chromosome  Position    Strand   Ref/SNP
example:   33941939        9       68878541       1       T/G
```

`--strain <strain_name>`
- The strain you would like to use as SNP (ALT) genome. Mandatory. For an overview of strain names just run SNPsplit_genome_preparation selecting `--list_strains`.

`--list_strains`
- Displays a list of strain names present in the VCF file for use with `--strain <strain_name>`.

`--dual_hybrid`
- Optional. The resulting genome will no longer relate to the original reference specified with `--reference_genome`. Instead the new Reference (Ref) is defined by `--strain <name>` and the new SNP genome is defined by `--strain2 <strain_name>`. `--dual_hybrid` automatically sets `--full_sequence`.

	**This will invoke a multi-step process:**
**1)** Read/filter SNPs for first strain (specified with `--strain < name>`)
**2)** Write full SNP incorporated (and optionally N-masked) genome sequence for first strain
**3)** Read/filter SNPs for second strain (specified with `--strain2 <name>`)
**4)** Write full SNP incorporated (and optionally N-masked) genome sequence for second strain
**5)** Generate new Ref/Alt SNP annotations for Strain1/Strain2
**6)** Set first strain as new reference genome and construct full SNP incorporated (and optionally N-masked) genome sequences for Strain1/Strain2

`--strain2 <strain_name>`
- Optional for constructing dual hybrid genomes (see `--dual_hybrid` for more information). For an overview of strain names just run SNPsplit_genome_preparation selecting `--list_strains`.

`--reference_genome`
- The path to the reference genome, typically the strain 'Black6' (C57BL/6J), e.g. `--reference_genome /bi/scratch/Genomes/Mouse/GRCm38/`. Expects one or more FastA files in this folder (file extension: `.fa` or `.fasta`).

`--skip_filtering`
- This option skips reading and filtering the VCF file. This assumes that a folder named `SNPs_<Strain_Name>` exists in the working directory, and that text files with SNP information are contained therein in the following format:
```
              SNP-ID     Chromosome  Position    Strand   Ref/SNP
example:   33941939        9       68878541       1       T/G
```

`--nmasking`
- Write out a genome version for the strain specified where Ref bases are replaced with `N`. In the Ref/SNP example T/G the N-masked genome would now carry an N instead of the T. The N-masked genome is written to a folder called  `<strain_name>_N-masked/`. Default: ON.

`--full_sequence`
- Write out a genome version for the strain specified where Ref bases are replaced with the SNP base. In the Ref/SNP example T/G the full sequence genome would now carry a G instead of the T. The full sequence genome is written out to folder called `<strain_name>_full_sequence/`. May be set in addition to `--nmasking`. Default: OFF.

`--no_nmasking`
- Disable N-masking if it is not desirable. Will automatically set `--full_sequence` instead.

`--genome_build <name>`
- Name of the mouse genome build, e.g. mm10. Will be incorporated into some of the output files. Defaults to `GRCm38`.

`--help`
- Displays this help information and exits.

`--version`
- Displays version information and exits.
